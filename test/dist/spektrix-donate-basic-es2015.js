!function(t){var e={};function n(o){if(e[o])return e[o].exports;var s=e[o]={i:o,l:!1,exports:{}};return t[o].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:o})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e,n){"use strict";n.r(e);var o=class extends HTMLElement{constructor(){super()}_submitRequest(t,e,n){const o="https://system.spektrix.com/"+this.systemName+"/api/v3/"+n;let s=JSON.stringify(t);return fetch(o,{credentials:"include",headers:{"Content-type":"application/json; charset=UTF-8"},method:e,body:s})}_customInputHandler(t,e){this.shadowRoot.addEventListener("input",n=>{let o=n.srcElement||n.target;null!==o.attributes.getNamedItem(t)&&e(o)})}};let s=document.createElement("template");s.innerHTML='\n<div class="thing" id="spektrix-donate-basic">\n  <slot name="slot" id="slot">\n</div>\n',window.ShadyCSS&&window.ShadyCSS.prepareTemplate(s,"native-web-component");window.customElements.define("spektrix-donate-basic",class extends o{constructor(){super(),window.ShadyCSS&&window.ShadyCSS.styleElement(this),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(document.importNode(s.content,!0)),this.interactionHandler()}connectedCallback(){this._customInputHandler("data-custom-donation-input",t=>{this._updateDonationTotal(t.value)})}set donationAmount(t){this._donationAmount!==t&&(this._donationAmount=t,this._donationAmountChanged(t),console.log("set donation"))}get donationAmount(){return this._donationAmount?this._donationAmount:0}set NextStep(t){this._nextStep!==t&&"string"==typeof t&&(this._nextStep=t)}get NextStep(){return this._nextStep?this._nextStep:null}set fundId(t){this._fundId!==t&&"string"==typeof t&&(this._fundId=t)}get fundId(){return this._fundId?this._fundId:null}set systemName(t){this._systemName!==t&&"string"==typeof t&&(this._systemName=t)}get systemName(){return this._systemName?this._systemName:null}postDonation(t){let e=[{amount:t,fundId:this.fundId}];this._submitRequest(e,"post","basket/donations").then(t=>{t.ok?t.json().then(t=>this._handleSuccessResponse(t)):t.json().then(t=>this._handleFailureResponse(t))}).catch(t=>{this._handleFailureResponse(t)})}_handleSuccessResponse(t){let e=new CustomEvent("success",{detail:t});this.dispatchEvent(e),this.nextStep&&(window.location.href=this.nextStep);let n=this._getElementFromSlot("[data-success-container]");if(n.length>0)for(let t of n)t.setAttribute("style","");else t.json().then(t=>console.log(t))}_handleFailureResponse(t){let e=new CustomEvent("fail",{detail:t});if(this.dispatchEvent(e),t instanceof Error)console.log("Error: ",t);else{let e=this._getElementFromSlot("[data-fail-container]");if(e.length>0)for(let n of e)n.textContent=t.message+" "+t.problems.toString(),n.setAttribute("style","")}}_updateDonationTotal(t){this.donationAmount=Number(t)}_donationAmountChanged(t,e){this._displayDonationAmount(t)}_displayDonationAmount(){let t=this._getElementFromSlot("[data-display-donation-amount]");if(t)for(let e of t)e.textContent=this.donationAmount||0}_getElementFromSlot(t){const e=this.shadowRoot.querySelector("#slot").assignedNodes({flatten:!0});let n=[];for(let o of e.filter(t=>(t=t,1===t.nodeType)))if((o.matches&&o.matches(t)||o.msMatchesSelector&&o.msMatchesSelector(t))&&n.push(o),o.children){let e=o.querySelectorAll(t);n.push(...e)}var o;return n}interactionHandler(){this.shadowRoot.addEventListener("click",t=>{null!==(t.srcElement||t.target).attributes.getNamedItem("data-submit-donation")&&this.postDonation(this.donationAmount)})}static get observedAttributes(){return["system-name","fund-id","next-step"]}attributeChangedCallback(t,e,n){let o=t.replace(/-([a-z])/g,function(t){return t[1].toUpperCase()});e!==n&&(this[o]=n)}})},function(t,e,n){t.exports=n(0)}]);